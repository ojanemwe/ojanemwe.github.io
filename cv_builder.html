<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenCV Builder - Pro Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;900&family=Playfair+Display:wght@700&family=Roboto+Mono:wght@400;700&family=Lora:wght@400;700&display=swap');

        :root {
            --primary-color: #2563eb;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }

        /* Kontainer Utama untuk memastikan Pratinjau tidak terpotong */
        #preview-main {
            padding-top: 2rem;
            padding-bottom: 5rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: calc(100vh - 4rem);
        }

        /* Ukuran Kertas A4 */
        .page-preview {
            width: 210mm;
            height: 297mm;
            background: white;
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
            position: relative;
            overflow: hidden;
            box-sizing: border-box;
            display: block;
            margin: 0 auto; /* Menghilangkan margin atas otomatis yang konflik */
            flex-shrink: 0;
        }

        /* ATS Specific Styles - Font Size Reduced Slightly */
        .ats-content {
            font-family: 'Lora', 'Times New Roman', serif;
            color: #000;
            line-height: 1.35; /* Sedikit lebih rapat */
            padding: 25mm 20mm; /* Standar margin A4 */
        }
        .ats-header { text-align: center; border-bottom: 1px solid #000; padding-bottom: 10px; margin-bottom: 15px; }
        .ats-name { font-size: 22pt; font-weight: bold; text-transform: uppercase; margin-bottom: 5px; } /* 24pt -> 22pt */
        .ats-contact { font-size: 9pt; } /* 10pt -> 9pt */
        .ats-section { margin-bottom: 12px; }
        .ats-section-title { font-size: 10pt; font-weight: bold; text-transform: uppercase; border-bottom: 1px solid #000; margin-bottom: 6px; padding-bottom: 2px; } /* 11pt -> 10pt */
        .ats-job-header { display: flex; justify-content: space-between; font-weight: bold; font-size: 10pt; } /* 11pt -> 10pt */
        .ats-job-sub { display: flex; justify-content: space-between; font-style: italic; font-size: 10pt; margin-bottom: 2px; } /* 11pt -> 10pt */
        .ats-list { list-style-type: disc; margin-left: 20px; font-size: 9.5pt; } /* 10.5pt -> 9.5pt */
        .ats-text-body { font-size: 9.5pt; } /* Kelas helper baru untuk body text */

        /* Responsivitas Skala untuk Layar Kecil */
        @media (max-width: 1024px) {
            #preview-main { padding-top: 1rem; }
            .page-preview {
                transform: scale(0.65);
                transform-origin: top center;
                margin-bottom: -100mm;
            }
        }

        @media (max-width: 640px) {
            .page-preview {
                transform: scale(0.38);
                margin-bottom: -180mm;
            }
        }

        /* PERBAIKAN FITUR CETAK */
        /* Default A4 tapi membiarkan user memilih di dialog print jika perlu */
        @page {
            margin: 0;
        }

        @media print {
            .no-print, nav, aside, button, .template-selector, .mobile-toggle { 
                display: none !important; 
            }
            
            body, html { 
                background: white !important; 
                margin: 0 !important; 
                padding: 0 !important;
                width: 100%;
                height: 100%;
            }

            #preview-main {
                padding: 0 !important;
                display: block !important;
                height: auto;
            }

            .page-preview {
                margin: 0 !important;
                border: none !important;
                box-shadow: none !important;
                transform: scale(1) !important;
                width: 210mm !important;
                height: 297mm !important; /* Tinggi tetap A4 */
                page-break-after: always !important;
                print-color-adjust: exact; 
                -webkit-print-color-adjust: exact;
            }

            * { 
                -webkit-print-color-adjust: exact !important; 
                print-color-adjust: exact !important; 
            }
        }

        .sidebar-scroll { height: calc(100vh - 4rem); overflow-y: auto; }

        /* Template: Bold Split */
        /* Warna background sidebar sekarang dinamis via inline style, default fallback ada di sini */
        .bold-sidebar { color: white; width: 32%; height: 100%; padding: 40px 25px; transition: background-color 0.3s; }
        .bold-main { width: 68%; padding: 45px; background: white; }
        .bold-photo { width: 140px; height: 140px; border-radius: 50%; border: 4px solid rgba(255,255,255,0.2); box-shadow: 0 0 20px rgba(0,0,0,0.2); object-fit: cover; }
        .bold-skill-bg { height: 4px; background: rgba(0,0,0,0.2); width: 100%; border-radius: 2px; }
        .bold-skill-fill { height: 100%; background: white; border-radius: 2px; }

        /* Template: Contemporary */
        .contemp-header { border-bottom: 1px solid #e5e7eb; padding-bottom: 30px; margin-bottom: 30px; }
        .contemp-grid { display: grid; grid-template-columns: 2fr 1fr; gap: 40px; }
        .contemp-section-title { font-family: 'Playfair Display', serif; font-size: 16px; font-weight: 700; border-bottom: 2px solid #000; padding-bottom: 4px; margin-bottom: 15px; text-transform: uppercase; }

        /* Helpers */
        .hidden-section { display: none !important; }

    </style>
</head>
<body class="text-gray-800">

    <nav class="bg-white border-b h-16 flex items-center justify-between px-6 sticky top-0 z-50 no-print">
        <div class="flex items-center gap-4">
            <button onclick="toggleSidebar()" class="lg:hidden text-gray-600 hover:text-blue-600 mobile-toggle">
                <i class="fas fa-bars text-xl"></i>
            </button>
            <div class="flex items-center gap-2 text-blue-600 font-bold text-xl">
                <i class="fas fa-id-card"></i> <span class="hidden sm:inline">CV Builder</span>
            </div>
        </div>
        <div class="flex items-center gap-4">
            <select id="langSwitch" onchange="generatePreview()" class="border rounded px-2 py-1 text-sm bg-gray-50 outline-none">
                <option value="id">Bahasa Indonesia</option>
                <option value="en">English</option>
            </select>
            <button onclick="window.print()" class="bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-semibold hover:bg-blue-700 transition shadow-lg">
                <i class="fas fa-print mr-2"></i> <span class="hidden sm:inline">Cetak CV (PDF)</span><span class="sm:hidden">PDF</span>
            </button>
        </div>
    </nav>

    <div id="app-container" class="flex flex-col lg:flex-row">
        
        <!-- SIDEBAR DIPERLEBAR: lg:w-1/3 dari sebelumnya lg:w-1/4 -->
        <aside id="sidebar" class="fixed inset-0 top-16 bg-white z-40 lg:relative lg:top-0 lg:w-1/3 xl:w-1/3 border-r no-print sidebar-scroll p-6 transform -translate-x-full lg:translate-x-0 transition-transform duration-300">
            <div class="space-y-6">
                <section>
                    <h2 class="text-[10px] font-black uppercase text-gray-400 mb-4 flex items-center gap-2">INFORMASI DASAR</h2>
                    <div class="space-y-3">
                        <div class="flex flex-col items-center gap-3 p-4 bg-gray-50 rounded-lg border border-dashed">
                            <div id="photo-preview-form" class="w-20 h-20 rounded-full bg-gray-200 overflow-hidden flex items-center justify-center border-2 border-white shadow-sm">
                                <i class="fas fa-user text-gray-400 text-2xl"></i>
                            </div>
                            <input type="file" id="input_photo" accept="image/*" class="text-[10px] w-full">
                        </div>
                        <input type="text" id="input_name" oninput="generatePreview()" placeholder="Nama Lengkap" class="w-full border rounded p-2 text-sm outline-none focus:border-blue-500">
                        <input type="text" id="input_title" oninput="generatePreview()" placeholder="Jabatan Profesional" class="w-full border rounded p-2 text-sm outline-none">
                        
                        <!-- Penambahan Checkbox Toggle untuk Profil Ringkas -->
                        <div class="flex items-center justify-between mt-2 px-1">
                            <label class="text-[10px] font-bold text-gray-500 uppercase">Profil Ringkas</label>
                            <label class="flex items-center cursor-pointer">
                                <input type="checkbox" id="toggle_summary" onchange="toggleSummary()" checked class="form-checkbox h-3 w-3 text-blue-600 rounded focus:ring-blue-500 border-gray-300">
                                <span class="ml-1 text-[9px] text-gray-400">Show</span>
                            </label>
                        </div>
                        <textarea id="input_summary" oninput="generatePreview()" placeholder="Profil Ringkas..." rows="4" class="w-full border rounded p-2 text-sm outline-none"></textarea>
                    </div>
                </section>

                <section>
                    <h2 class="text-[10px] font-black uppercase text-gray-400 mb-4">WARNA TEMA</h2>
                    <p class="text-[9px] text-gray-400 mb-2">Mencakup latar belakang sidebar (Bold Split) dan aksen.</p>
                    <input type="color" id="input_color" value="#2563eb" oninput="generatePreview()" class="w-full h-10 border rounded cursor-pointer">
                </section>

                <section>
                    <div class="flex justify-between items-center mb-3">
                        <h2 class="text-[10px] font-black text-gray-400 uppercase">PENGALAMAN KERJA</h2>
                        <button onclick="addEntry('work')" class="text-blue-600 text-[10px] font-bold">+ TAMBAH</button>
                    </div>
                    <div id="work_entries" class="space-y-3"></div>
                </section>

                <section>
                    <div class="flex justify-between items-center mb-3">
                        <h2 class="text-[10px] font-black text-gray-400 uppercase">PENDIDIKAN</h2>
                        <button onclick="addEntry('education')" class="text-blue-600 text-[10px] font-bold">+ TAMBAH</button>
                    </div>
                    <div id="education_entries" class="space-y-3"></div>
                </section>

                <section>
                    <div class="flex justify-between items-center mb-3">
                        <h2 class="text-[10px] font-black text-gray-400 uppercase">KEAHLIAN (HARD/SOFT SKILL)</h2>
                        <button onclick="addSkill()" class="text-blue-600 text-[10px] font-bold">+ TAMBAH</button>
                    </div>
                    <div id="skill_entries" class="space-y-2"></div>
                </section>

                <!-- Section: BAHASA -->
                <section>
                    <div class="flex justify-between items-center mb-3">
                        <h2 class="text-[10px] font-black text-gray-400 uppercase">BAHASA</h2>
                        <button onclick="addLanguage()" class="text-blue-600 text-[10px] font-bold">+ TAMBAH</button>
                    </div>
                    <div id="language_entries" class="space-y-2"></div>
                </section>

                <!-- Section: SERTIFIKASI -->
                <section>
                    <div class="flex justify-between items-center mb-3">
                        <div class="flex items-center gap-2">
                            <h2 class="text-[10px] font-black text-gray-400 uppercase">SERTIFIKASI</h2>
                            <label class="flex items-center cursor-pointer">
                                <input type="checkbox" id="toggle_cert" onchange="toggleCert()" checked class="form-checkbox h-3 w-3 text-blue-600 rounded focus:ring-blue-500 border-gray-300">
                                <span class="ml-1 text-[9px] text-gray-400">Show</span>
                            </label>
                        </div>
                        <button onclick="addCertification()" class="text-blue-600 text-[10px] font-bold">+ TAMBAH</button>
                    </div>
                    <div id="certification_entries" class="space-y-3"></div>
                </section>

                <button onclick="toggleSidebar()" class="w-full bg-gray-800 text-white py-3 rounded-lg font-bold lg:hidden">LIHAT HASIL</button>
            </div>
        </aside>

        <main id="preview-main" class="flex-1 bg-gray-100 overflow-y-auto">
            <div class="template-selector flex flex-wrap justify-center gap-2 mb-8 no-print">
                <button onclick="selectTemplate('bold-split')" class="px-5 py-2 rounded-full bg-white shadow-sm font-bold text-[10px] hover:bg-blue-600 hover:text-white transition">BOLD SPLIT</button>
                <button onclick="selectTemplate('contemporary-grid')" class="px-5 py-2 rounded-full bg-white shadow-sm font-bold text-[10px] hover:bg-blue-600 hover:text-white transition">CONTEMPORARY</button>
                <button onclick="selectTemplate('modern-minimal')" class="px-5 py-2 rounded-full bg-white shadow-sm font-bold text-[10px] hover:bg-blue-600 hover:text-white transition">MINIMALIST</button>
                <button onclick="selectTemplate('ats')" class="px-5 py-2 rounded-full bg-white shadow-sm font-bold text-[10px] border border-gray-300 hover:bg-black hover:text-white transition">FORMAT ATS (TEXT)</button>
            </div>

            <div id="creative-page" class="page-preview"></div>
        </main>
    </div>

    <script>
        let appData = {
            lang: 'id',
            template: 'bold-split',
            color: '#1a1e26', // Default dark
            photo: '',
            showCert: true,
            showSummary: true,
            personal: { 
                name: 'Alex Morgan', 
                title: 'SENIOR UI/UX DESIGNER', 
                email: 'alex.morgan@design.com', 
                phone: '+1 (555) 123-4567', 
                location: 'San Francisco, CA', 
                summary: 'Passionate about creating intuitive and visually stunning digital experiences. Specialized in mobile app design, design systems, and rapid prototyping. I bridge the gap between aesthetics and functionality.' 
            },
            work: [
                { instansi: 'Creative Solutions Inc.', logo: '', pos: 'Senior Product Designer', startYear: '2021', endYear: 'Present', desc: 'Led the redesign of the core mobile application, resulting in a 40% increase in user engagement.' },
                { instansi: 'TechFlow Agency', logo: '', pos: 'UI/UX Designer', startYear: '2018', endYear: '2021', desc: 'Collaborated with developers to implement responsive web designs for fintech clients.' }
            ],
            education: [
                { instansi: 'University of California', major: 'BFA in Interaction Design', startYear: '2014', endYear: '2018' }
            ],
            skills: [
                { name: 'UI/UX Design', level: 95 },
                { name: 'Figma / Sketch', level: 90 },
                { name: 'Prototyping', level: 85 },
                { name: 'HTML / CSS', level: 75 }
            ],
            languages: [
                { name: 'English', level: 'Native' },
                { name: 'Spanish', level: 'Professional' }
            ],
            certifications: [
                { name: 'Google UX Design Professional Certificate', year: '2021' },
                { name: 'Certified ScrumMaster (CSM)', year: '2020' }
            ],
            interests: ['Photography', 'Hiking', '3D Modeling', 'Coffee']
        };

        const translations = {
            id: { work: 'Pengalaman Kerja', edu: 'Pendidikan', skill: 'Keahlian', lang: 'Bahasa', cert: 'Sertifikasi', contact: 'Kontak', about: 'Tentang Saya' },
            en: { work: 'Work Experience', edu: 'Education', skill: 'Skills', lang: 'Languages', cert: 'Certifications', contact: 'Contact', about: 'About Me' }
        };

        function toggleSidebar() { document.getElementById('sidebar').classList.toggle('-translate-x-full'); }
        function toggleCert() { appData.showCert = document.getElementById('toggle_cert').checked; generatePreview(); }
        function toggleSummary() { appData.showSummary = document.getElementById('toggle_summary').checked; generatePreview(); }

        window.onload = () => {
            syncFormInputs();
            renderFormLists();
            generatePreview();

            document.getElementById('input_photo').onchange = function(e) {
                const reader = new FileReader();
                reader.onload = (ev) => {
                    appData.photo = ev.target.result;
                    document.getElementById('photo-preview-form').innerHTML = `<img src="${ev.target.result}" class="w-full h-full object-cover">`;
                    generatePreview();
                };
                if(e.target.files[0]) reader.readAsDataURL(e.target.files[0]);
            };
        };

        function syncFormInputs() {
            const p = appData.personal;
            document.getElementById('input_name').value = p.name;
            document.getElementById('input_title').value = p.title;
            document.getElementById('input_summary').value = p.summary;
            document.getElementById('input_color').value = appData.color;
            document.getElementById('toggle_cert').checked = appData.showCert;
            document.getElementById('toggle_summary').checked = appData.showSummary;
        }

        function renderFormLists() {
            // WORK
            const wBox = document.getElementById('work_entries');
            wBox.innerHTML = '';
            appData.work.forEach((w, i) => {
                wBox.innerHTML += `<div class="p-3 bg-gray-50 border rounded text-xs relative">
                    <button onclick="removeEntry('work', ${i})" class="absolute top-1 right-1 text-red-400">×</button>
                    <div class="mb-2">
                         <label class="block text-[9px] text-gray-400 mb-1">Logo Perusahaan</label>
                         <input type="file" onchange="handleLogoUpload(event, ${i})" accept="image/*" class="text-[9px] w-full">
                    </div>
                    <input type="text" oninput="appData.work[${i}].pos = this.value; generatePreview()" value="${w.pos}" placeholder="Jabatan" class="w-full font-bold bg-transparent mb-1">
                    <input type="text" oninput="appData.work[${i}].instansi = this.value; generatePreview()" value="${w.instansi}" placeholder="Nama Perusahaan" class="w-full bg-transparent mb-1">
                    <div class="flex gap-2">
                        <input type="text" oninput="appData.work[${i}].startYear = this.value; generatePreview()" value="${w.startYear}" placeholder="Thn Mulai" class="w-1/2 border rounded p-1">
                        <input type="text" oninput="appData.work[${i}].endYear = this.value; generatePreview()" value="${w.endYear}" placeholder="Thn Akhir" class="w-1/2 border rounded p-1">
                    </div>
                    <textarea oninput="appData.work[${i}].desc = this.value; generatePreview()" placeholder="Deskripsi Pekerjaan..." class="w-full bg-transparent mt-1 border-t pt-1 h-16">${w.desc}</textarea>
                </div>`;
            });

            // EDUCATION
            const eBox = document.getElementById('education_entries');
            eBox.innerHTML = '';
            appData.education.forEach((e, i) => {
                eBox.innerHTML += `<div class="p-3 bg-gray-50 border rounded text-xs relative">
                    <button onclick="removeEntry('education', ${i})" class="absolute top-1 right-1 text-red-400">×</button>
                    <input type="text" oninput="appData.education[${i}].instansi = this.value; generatePreview()" value="${e.instansi}" placeholder="Nama Sekolah/Univ" class="w-full font-bold bg-transparent mb-1">
                    <input type="text" oninput="appData.education[${i}].major = this.value; generatePreview()" value="${e.major}" placeholder="Jurusan/Gelar" class="w-full bg-transparent mb-1">
                    <div class="flex gap-2">
                        <input type="text" oninput="appData.education[${i}].startYear = this.value; generatePreview()" value="${e.startYear}" placeholder="Thn Mulai" class="w-1/2 border rounded p-1">
                        <input type="text" oninput="appData.education[${i}].endYear = this.value; generatePreview()" value="${e.endYear}" placeholder="Thn Akhir" class="w-1/2 border rounded p-1">
                    </div>
                </div>`;
            });

            // SKILLS
            const sBox = document.getElementById('skill_entries');
            sBox.innerHTML = '';
            appData.skills.forEach((s, i) => {
                sBox.innerHTML += `<div class="flex gap-2 relative">
                     <button onclick="removeEntry('skills', ${i})" class="text-red-400 text-[10px] font-bold absolute -right-2 -top-2">x</button>
                    <input type="text" oninput="appData.skills[${i}].name = this.value; generatePreview()" value="${s.name}" class="flex-1 text-[10px] border p-1 rounded">
                    <input type="number" oninput="appData.skills[${i}].level = this.value; generatePreview()" value="${s.level}" class="w-10 text-[10px] border p-1 rounded">
                </div>`;
            });

            // LANGUAGES
            const lBox = document.getElementById('language_entries');
            lBox.innerHTML = '';
            appData.languages.forEach((l, i) => {
                lBox.innerHTML += `<div class="flex gap-2 relative">
                    <button onclick="removeEntry('languages', ${i})" class="text-red-400 text-[10px] font-bold absolute -right-2 -top-2">x</button>
                    <input type="text" oninput="appData.languages[${i}].name = this.value; generatePreview()" value="${l.name}" placeholder="Bahasa" class="flex-1 text-[10px] border p-1 rounded">
                    <input type="text" oninput="appData.languages[${i}].level = this.value; generatePreview()" value="${l.level}" placeholder="Level (ex: Native)" class="flex-1 text-[10px] border p-1 rounded">
                </div>`;
            });

            // CERTIFICATIONS
            const cBox = document.getElementById('certification_entries');
            cBox.innerHTML = '';
            appData.certifications.forEach((c, i) => {
                cBox.innerHTML += `<div class="p-2 bg-gray-50 border rounded text-xs relative">
                    <button onclick="removeEntry('certifications', ${i})" class="absolute top-1 right-1 text-red-400">×</button>
                    <input type="text" oninput="appData.certifications[${i}].name = this.value; generatePreview()" value="${c.name}" placeholder="Nama Sertifikat" class="w-full font-bold bg-transparent mb-1">
                    <input type="text" oninput="appData.certifications[${i}].year = this.value; generatePreview()" value="${c.year}" placeholder="Tahun" class="w-1/3 border rounded p-1">
                </div>`;
            });
        }

        function handleLogoUpload(e, i) {
            const reader = new FileReader();
            reader.onload = (ev) => {
                appData.work[i].logo = ev.target.result;
                generatePreview();
            };
            if(e.target.files[0]) reader.readAsDataURL(e.target.files[0]);
        }

        function addEntry(type) { 
            if(type === 'work') appData.work.push({ instansi: '', logo: '', pos: '', startYear: '', endYear: '', desc: '' });
            if(type === 'education') appData.education.push({ instansi: '', major: '', startYear: '', endYear: '' });
            renderFormLists(); generatePreview(); 
        }
        function addSkill() { appData.skills.push({ name: '', level: 80 }); renderFormLists(); generatePreview(); }
        function addLanguage() { appData.languages.push({ name: '', level: '' }); renderFormLists(); generatePreview(); }
        function addCertification() { appData.certifications.push({ name: '', year: '' }); renderFormLists(); generatePreview(); }
        
        function removeEntry(type, i) { appData[type].splice(i, 1); renderFormLists(); generatePreview(); }
        function selectTemplate(t) { appData.template = t; generatePreview(); }

        function generatePreview() {
            appData.personal.name = document.getElementById('input_name').value;
            appData.personal.title = document.getElementById('input_title').value;
            appData.personal.summary = document.getElementById('input_summary').value;
            appData.color = document.getElementById('input_color').value;
            appData.lang = document.getElementById('langSwitch').value;
            document.documentElement.style.setProperty('--primary-color', appData.color);
            renderPage();
        }

        function renderPage() {
            const page = document.getElementById('creative-page');
            const d = appData;
            const t = translations[d.lang];
            const p = d.personal;
            const photoUrl = d.photo || 'https://i.pravatar.cc/300?img=12';

            if(d.template === 'ats') {
                page.innerHTML = `
                <div class="ats-content">
                    <div class="ats-header">
                        <div class="ats-name">${p.name}</div>
                        <div class="ats-contact">
                            ${p.location} | ${p.phone} | ${p.email}
                        </div>
                    </div>

                    ${d.showSummary ? `
                    <div class="ats-section">
                        <div class="ats-section-title">${t.about.toUpperCase()}</div>
                        <p class="ats-text-body">${p.summary}</p>
                    </div>` : ''}

                    <div class="ats-section">
                        <div class="ats-section-title">${t.work.toUpperCase()}</div>
                        ${d.work.map(w => `
                            <div style="margin-bottom: 10px;">
                                <div class="ats-job-header">
                                    <span>${w.instansi}</span>
                                    <span>${w.startYear} - ${w.endYear}</span>
                                </div>
                                <div class="ats-job-sub">
                                    <span>${w.pos}</span>
                                </div>
                                <p class="ats-text-body" style="margin-top: 2px;">${w.desc}</p>
                            </div>
                        `).join('')}
                    </div>

                    <div class="ats-section">
                        <div class="ats-section-title">${t.edu.toUpperCase()}</div>
                        ${d.education.map(e => `
                            <div style="margin-bottom: 5px;">
                                <div class="ats-job-header">
                                    <span>${e.instansi}</span>
                                    <span>${e.startYear} - ${e.endYear}</span>
                                </div>
                                <div class="ats-job-sub">
                                    <span>${e.major}</span>
                                </div>
                            </div>
                        `).join('')}
                    </div>

                    <div class="ats-section">
                        <div class="ats-section-title">${t.skill.toUpperCase()}</div>
                        <p class="ats-text-body">${d.skills.map(s => s.name).join(', ')}</p>
                    </div>

                    <div class="ats-section">
                        <div class="ats-section-title">${t.lang.toUpperCase()}</div>
                        <ul class="ats-list">
                            ${d.languages.map(l => `<li>${l.name} (${l.level})</li>`).join('')}
                        </ul>
                    </div>

                    ${d.showCert ? `
                    <div class="ats-section">
                        <div class="ats-section-title">${t.cert.toUpperCase()}</div>
                        <ul class="ats-list">
                            ${d.certifications.map(c => `<li>${c.name} (${c.year})</li>`).join('')}
                        </ul>
                    </div>` : ''}
                </div>`;
            } else if(d.template === 'bold-split') {
                page.innerHTML = `
                <div class="flex h-full">
                    <div class="bold-sidebar flex flex-col items-center" style="background-color: ${appData.color}">
                        <img src="${photoUrl}" class="bold-photo mb-6">
                        <h1 class="text-2xl font-black text-center mb-1 uppercase tracking-tight">${p.name}</h1>
                        <p class="text-[10px] text-center font-bold tracking-[0.15em] mb-12 uppercase opacity-80">${p.title}</p>
                        
                        <div class="w-full mb-10">
                            <h3 class="text-[10px] font-black uppercase border-b border-white/20 pb-2 mb-4 tracking-widest opacity-60">${t.contact}</h3>
                            <div class="space-y-3 text-[10px]">
                                <div class="flex items-center gap-3"><i class="fas fa-envelope opacity-70 w-4 text-center"></i> <span>${p.email}</span></div>
                                <div class="flex items-center gap-3"><i class="fas fa-phone opacity-70 w-4 text-center"></i> <span>${p.phone}</span></div>
                                <div class="flex items-center gap-3"><i class="fas fa-map-marker-alt opacity-70 w-4 text-center"></i> <span>${p.location}</span></div>
                            </div>
                        </div>

                        <div class="w-full mb-8">
                            <h3 class="text-[10px] font-black uppercase border-b border-white/20 pb-2 mb-4 tracking-widest opacity-60">${t.lang}</h3>
                            <div class="space-y-2">
                                ${d.languages.map(l => `<div class="flex justify-between text-[10px]"><span>${l.name}</span><span class="opacity-70">${l.level}</span></div>`).join('')}
                            </div>
                        </div>

                        <div class="w-full mb-8">
                            <h3 class="text-[10px] font-black uppercase border-b border-white/20 pb-2 mb-4 tracking-widest opacity-60">${t.skill}</h3>
                            <div class="space-y-4">
                                ${d.skills.map(s => `
                                    <div>
                                        <div class="flex justify-between text-[9px] mb-1.5 font-bold uppercase tracking-tighter"><span>${s.name}</span><span class="opacity-60">${s.level}%</span></div>
                                        <div class="bold-skill-bg"><div class="bold-skill-fill" style="width:${s.level}%"></div></div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                    <div class="bold-main">
                        ${d.showSummary ? `
                        <div class="w-full mb-8">
                            <h3 class="text-xs font-black uppercase border-b-2 border-gray-100 pb-2 mb-4 tracking-widest text-gray-400">${t.about}</h3>
                            <p class="text-[11px] leading-relaxed text-gray-600">${p.summary}</p>
                        </div>` : ''}

                        <div class="flex items-center gap-3 mb-6">
                            <div class="w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center" style="color:${appData.color}">
                                <i class="fas fa-briefcase"></i>
                            </div>
                            <h2 class="text-xl font-black text-gray-800 uppercase tracking-tight">${t.work}</h2>
                        </div>
                        <div class="space-y-8 relative mb-8">
                            <div class="absolute left-[7px] top-2 bottom-2 w-0.5 bg-gray-100"></div>
                            ${d.work.map(w => `
                                <div class="relative pl-8">
                                    <div class="absolute left-0 top-1.5 w-4 h-4 rounded-full bg-white border-4" style="border-color:${appData.color}"></div>
                                    <div class="flex justify-between items-center mb-1">
                                        <div class="flex items-center gap-2">
                                            ${w.logo ? `<img src="${w.logo}" class="w-6 h-6 object-contain rounded-full border">` : ''}
                                            <h4 class="text-sm font-bold text-gray-900">${w.pos}</h4>
                                        </div>
                                        <span class="text-[9px] font-bold text-gray-400 bg-gray-100 px-2 py-0.5 rounded uppercase tracking-wider">${w.startYear} - ${w.endYear}</span>
                                    </div>
                                    <p class="text-[11px] font-bold mb-2" style="color:${appData.color}">${w.instansi}</p>
                                    <p class="text-[10px] text-gray-500 leading-relaxed">${w.desc}</p>
                                </div>
                            `).join('')}
                        </div>

                        <div class="flex items-center gap-3 mb-6">
                            <div class="w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center" style="color:${appData.color}">
                                <i class="fas fa-graduation-cap"></i>
                            </div>
                            <h2 class="text-xl font-black text-gray-800 uppercase tracking-tight">${t.edu}</h2>
                        </div>
                        <div class="space-y-4 mb-8">
                            ${d.education.map(e => `
                                <div class="flex justify-between items-start border-l-2 pl-4" style="border-color:${appData.color}">
                                    <div>
                                        <h4 class="text-sm font-bold text-gray-900">${e.instansi}</h4>
                                        <p class="text-[11px] text-gray-600">${e.major}</p>
                                    </div>
                                    <span class="text-[10px] font-bold text-gray-400">${e.startYear} - ${e.endYear}</span>
                                </div>
                            `).join('')}
                        </div>

                        ${d.showCert ? `
                        <div class="flex items-center gap-3 mb-6">
                            <div class="w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center" style="color:${appData.color}">
                                <i class="fas fa-certificate"></i>
                            </div>
                            <h2 class="text-xl font-black text-gray-800 uppercase tracking-tight">${t.cert}</h2>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            ${d.certifications.map(c => `
                                <div class="p-3 bg-gray-50 rounded border border-gray-100">
                                    <h4 class="text-[10px] font-bold text-gray-800">${c.name}</h4>
                                    <p class="text-[9px] font-bold" style="color:${appData.color}">${c.year}</p>
                                </div>
                            `).join('')}
                        </div>` : ''}
                    </div>
                </div>`;
            } else if(d.template === 'contemporary-grid') {
                page.innerHTML = `
                <div class="p-16 h-full flex flex-col bg-[#fcfcfc]">
                    <div class="flex items-center gap-8 mb-12">
                        <img src="${photoUrl}" class="w-32 h-32 rounded-full grayscale object-cover">
                        <div>
                            <h1 class="text-4xl font-black text-gray-900 uppercase tracking-tighter leading-none mb-2">${p.name}</h1>
                            <p class="text-sm font-bold tracking-[0.3em] text-blue-600 mb-4 uppercase" style="color:${appData.color}">${p.title}</p>
                            ${d.showSummary ? `<p class="text-[11px] text-gray-500 leading-relaxed max-w-xl italic">${p.summary}</p>` : ''}
                        </div>
                    </div>
                    <div class="contemp-grid flex-grow">
                        <div class="space-y-12">
                            <section>
                                <div class="flex items-center gap-3 mb-6">
                                    <i class="fas fa-briefcase text-gray-400"></i>
                                    <h2 class="contemp-section-title">${t.work}</h2>
                                </div>
                                <div class="space-y-8">
                                    ${d.work.map(w => `
                                        <div class="relative pl-6">
                                            <div class="absolute left-0 top-1.5 w-2 h-2 rounded-full" style="background-color:${appData.color}"></div>
                                            <div class="flex justify-between items-baseline mb-1">
                                                <div class="flex items-center gap-2">
                                                    ${w.logo ? `<img src="${w.logo}" class="w-6 h-6 object-contain">` : ''}
                                                    <h4 class="text-sm font-bold text-gray-900">${w.pos}</h4>
                                                </div>
                                                <span class="text-[9px] font-black text-gray-300 uppercase">${w.startYear} - ${w.endYear}</span>
                                            </div>
                                            <p class="text-[11px] font-medium text-gray-500 mb-2">${w.instansi}</p>
                                            <p class="text-[10px] text-gray-600 leading-relaxed">${w.desc}</p>
                                        </div>
                                    `).join('')}
                                </div>
                            </section>
                            
                            <section>
                                <div class="flex items-center gap-3 mb-6">
                                    <i class="fas fa-graduation-cap text-gray-400"></i>
                                    <h2 class="contemp-section-title">${t.edu}</h2>
                                </div>
                                <div class="space-y-6">
                                    ${d.education.map(e => `
                                        <div>
                                            <h4 class="text-sm font-bold text-gray-900">${e.instansi}</h4>
                                            <div class="flex justify-between items-center text-gray-500">
                                                <span class="text-[11px] italic">${e.major}</span>
                                                <span class="text-[9px] font-bold">${e.startYear} - ${e.endYear}</span>
                                            </div>
                                        </div>
                                    `).join('')}
                                </div>
                            </section>

                            ${d.showCert ? `
                            <section>
                                <div class="flex items-center gap-3 mb-6">
                                    <i class="fas fa-certificate text-gray-400"></i>
                                    <h2 class="contemp-section-title">${t.cert}</h2>
                                </div>
                                <div class="grid grid-cols-2 gap-4">
                                    ${d.certifications.map(c => `
                                        <div class="mb-2">
                                            <h4 class="text-[10px] font-bold text-gray-900">${c.name}</h4>
                                            <p class="text-[9px] text-gray-400 font-bold uppercase">${c.year}</p>
                                        </div>
                                    `).join('')}
                                </div>
                            </section>` : ''}
                        </div>
                        <aside class="space-y-12 bg-gray-50/50 p-8 rounded-2xl border border-gray-100 h-fit">
                            <section>
                                <h3 class="text-[10px] font-black uppercase tracking-widest text-gray-400 mb-4">${t.contact}</h3>
                                <div class="space-y-4 text-[10px]">
                                    <div class="flex items-center gap-3"><i class="fas fa-envelope text-gray-400"></i> ${p.email}</div>
                                    <div class="flex items-center gap-3"><i class="fas fa-phone text-gray-400"></i> ${p.phone}</div>
                                    <div class="flex items-center gap-3"><i class="fas fa-map-marker-alt text-gray-400"></i> ${p.location}</div>
                                </div>
                            </section>
                            <section>
                                <h3 class="text-[10px] font-black uppercase tracking-widest text-gray-400 mb-4">${t.lang}</h3>
                                <div class="space-y-2">
                                    ${d.languages.map(l => `<div class="flex justify-between text-[10px] font-bold text-gray-600"><span>${l.name}</span><span class="text-gray-400 font-normal">${l.level}</span></div>`).join('')}
                                </div>
                            </section>
                            <section>
                                <h3 class="text-[10px] font-black uppercase tracking-widest text-gray-400 mb-4">${t.skill}</h3>
                                <div class="flex flex-wrap gap-2">
                                    ${d.skills.map(s => `<span class="bg-white border border-gray-200 text-[8px] font-bold px-3 py-1.5 rounded uppercase tracking-tighter shadow-sm">${s.name}</span>`).join('')}
                                </div>
                            </section>
                        </aside>
                    </div>
                </div>`;
            } else {
                page.innerHTML = `
                <div class="p-20 h-full flex flex-col items-center">
                    <img src="${photoUrl}" class="w-32 h-32 rounded-full mb-8 border-4 border-white shadow-xl">
                    <header class="text-center mb-16">
                        <h1 class="text-5xl font-black tracking-tight text-gray-900 mb-2">${p.name}</h1>
                        <p class="text-base font-medium tracking-[0.2em] uppercase" style="color:${appData.color}">${p.title}</p>
                    </header>
                    <div class="w-full max-w-3xl grid grid-cols-3 gap-16">
                        <div class="col-span-1 space-y-12">
                            <section>
                                <h2 class="text-[11px] font-black uppercase tracking-widest text-gray-300 mb-4">${t.contact}</h2>
                                <div class="space-y-3 text-[10px] text-gray-600">
                                    <p>${p.email}</p><p>${p.phone}</p><p>${p.location}</p>
                                </div>
                            </section>
                            <section>
                                <h2 class="text-[11px] font-black uppercase tracking-widest text-gray-300 mb-4">${t.lang}</h2>
                                <div class="space-y-2 text-[10px] text-gray-600">
                                    ${d.languages.map(l => `<p>${l.name} <span class="text-gray-400">(${l.level})</span></p>`).join('')}
                                </div>
                            </section>
                            <section>
                                <h2 class="text-[11px] font-black uppercase tracking-widest text-gray-300 mb-4">${t.skill}</h2>
                                <div class="space-y-2 text-[10px] font-medium text-gray-800">
                                    ${d.skills.map(s => `<p>${s.name}</p>`).join('')}
                                </div>
                            </section>
                        </div>
                        <div class="col-span-2 space-y-12">
                            ${d.showSummary ? `
                            <section>
                                <h2 class="text-[11px] font-black uppercase tracking-widest text-gray-300 mb-4">${t.about.toUpperCase()}</h2>
                                <p class="text-[12px] text-gray-600 leading-relaxed">${p.summary}</p>
                            </section>` : ''}
                            <section>
                                <h2 class="text-[11px] font-black uppercase tracking-widest text-gray-300 mb-6">${t.work.toUpperCase()}</h2>
                                <div class="space-y-10">
                                    ${d.work.map(w => `
                                        <div>
                                            <div class="flex justify-between items-baseline mb-2">
                                                <div class="flex items-center gap-2">
                                                    ${w.logo ? `<img src="${w.logo}" class="w-5 h-5 object-contain">` : ''}
                                                    <h4 class="text-sm font-bold uppercase tracking-wide">${w.pos}</h4>
                                                </div>
                                                <span class="text-[9px] text-gray-400 font-bold">${w.startYear} - ${w.endYear}</span>
                                            </div>
                                            <p class="text-[10px] font-bold mb-3" style="color:${appData.color}">${w.instansi}</p>
                                            <p class="text-[10px] text-gray-600">${w.desc}</p>
                                        </div>
                                    `).join('')}
                                </div>
                            </section>
                            <section>
                                <h2 class="text-[11px] font-black uppercase tracking-widest text-gray-300 mb-6">${t.edu.toUpperCase()}</h2>
                                <div class="space-y-4">
                                    ${d.education.map(e => `
                                        <div>
                                            <div class="flex justify-between">
                                                <h4 class="text-xs font-bold text-gray-800">${e.instansi}</h4>
                                                <span class="text-[9px] text-gray-400 font-bold">${e.startYear} - ${e.endYear}</span>
                                            </div>
                                            <p class="text-[10px] text-gray-600">${e.major}</p>
                                        </div>
                                    `).join('')}
                                </div>
                            </section>
                            ${d.showCert ? `
                            <section>
                                <h2 class="text-[11px] font-black uppercase tracking-widest text-gray-300 mb-6">${t.cert.toUpperCase()}</h2>
                                <div class="space-y-4">
                                    ${d.certifications.map(c => `
                                        <div>
                                            <h4 class="text-xs font-bold text-gray-800">${c.name}</h4>
                                            <p class="text-[9px] font-bold" style="color:${appData.color}">${c.year}</p>
                                        </div>
                                    `).join('')}
                                </div>
                            </section>` : ''}
                        </div>
                    </div>
                </div>`;
            }
        }
    </script>
</body>
</html>